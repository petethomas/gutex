<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Gutex - Project Gutenberg Reader</title>

  <!-- Privacy-friendly analytics by Plausible -->
  <script async src="https://plausible.io/js/pa-vnjNSDGjn2um_Ck72v_qw.js"></script>
  <script>
    window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
    plausible.init()
  </script>
  <style>
/* CSS_PLACEHOLDER */
  </style>
</head>
<body>
  <!-- Room Banner - always visible when in room -->
  <div class="room-banner" id="roomBanner">
    <div class="room-info">
      <span>Room:</span>
      <span class="room-code" id="bannerRoomCode"></span>
      <button class="copy-btn" id="bannerCopyBtn">Copy</button>
    </div>
    <span class="peer-count" id="bannerPeerCount">1 person</span>
    <button class="leave-btn" id="bannerLeaveBtn">Leave</button>
  </div>

  <div class="container">
    <h1>Gutex</h1>
    <p class="tagline">Navigate <a href="https://gutenberg.org" target="_blank">Project Gutenberg</a> eBooks</p>
    
    <div class="search-box">
      <input type="text" id="query" placeholder="Search by title or author..." autofocus>
      <select id="langSelect" class="lang-select" title="Search language">
        <option value="en" title="English">ğŸ‡¬ğŸ‡§ EN</option>
        <option value="de" title="German">ğŸ‡©ğŸ‡ª DE</option>
        <option value="fr" title="French">ğŸ‡«ğŸ‡· FR</option>
        <option value="es" title="Spanish">ğŸ‡ªğŸ‡¸ ES</option>
        <option value="it" title="Italian">ğŸ‡®ğŸ‡¹ IT</option>
        <option value="pt" title="Portuguese">ğŸ‡µğŸ‡¹ PT</option>
        <option value="nl" title="Dutch">ğŸ‡³ğŸ‡± NL</option>
        <option value="fi" title="Finnish">ğŸ‡«ğŸ‡® FI</option>
        <option value="zh" title="Chinese">ğŸ‡¨ğŸ‡³ ZH</option>
        <option value="ja" title="Japanese">ğŸ‡¯ğŸ‡µ JA</option>
        <option value="la" title="Latin">ğŸ›ï¸ LA</option>
        <option value="el" title="Greek">ğŸ‡¬ğŸ‡· EL</option>
        <option value="all" title="All Languages">ğŸŒ All</option>
      </select>
      <button id="searchBtn">Search</button>
    </div>
    
    <div id="status"></div>
    <ul class="results" id="results"></ul>

    <!-- Peer activity display -->
    <div class="peer-activity" id="peerActivity">
      <div class="peer-header">
        <span id="peerActivityName"></span>
        <span class="typing-indicator" id="typingIndicator" style="display: none;">
          <span></span><span></span><span></span>
        </span>
      </div>
      <div class="activity-content" id="peerActivityContent"></div>
    </div>
    
    <div class="popular">
      <h2>Popular Books</h2>
      <div class="popular-grid">
        <a href="/read#1342"><span class="id">#1342</span> Pride and Prejudice</a>
        <a href="/read#11"><span class="id">#11</span> Alice in Wonderland</a>
        <a href="/read#1661"><span class="id">#1661</span> Sherlock Holmes</a>
        <a href="/read#84"><span class="id">#84</span> Frankenstein</a>
        <a href="/read#345"><span class="id">#345</span> Dracula</a>
        <a href="/read#2701"><span class="id">#2701</span> Moby Dick</a>
        <a href="/read#174"><span class="id">#174</span> Dorian Gray</a>
        <a href="/read#98"><span class="id">#98</span> Tale of Two Cities</a>
        <a href="/read#1232"><span class="id">#1232</span> The Prince</a>
        <a href="/read#996"><span class="id">#996</span> Don Quixote</a>
        <a href="/read#6920"><span class="id">#6920</span> Meditations</a>
        <a href="/read#1952"><span class="id">#1952</span> Yellow Wallpaper</a>
      </div>
    </div>
  </div>

  <!-- P2P Toggle Button -->
  <button class="p2p-toggle" id="p2pToggle" title="Join a Room">ğŸ‘¥</button>

  <!-- P2P Panel -->
  <div class="p2p-panel" id="p2pPanel">
    <div class="p2p-header">
      <h3>Join a Room</h3>
      <button id="p2pClose">âœ•</button>
    </div>
    <div class="p2p-status">
      <span class="status-dot" id="p2pStatusDot"></span>
      <span id="p2pStatusText">Connecting...</span>
    </div>
    <div class="p2p-content">
      <!-- Display Name -->
      <div class="p2p-section">
        <h4>Your Name</h4>
        <div class="p2p-input-group">
          <input type="text" id="p2pDisplayName" placeholder="Enter your name...">
        </div>
      </div>

      <!-- Join Room -->
      <div class="p2p-section">
        <h4>Join a Room</h4>
        <div class="p2p-input-group">
          <input type="text" id="p2pRoomCodeInput" placeholder="Room code..." maxlength="6" style="text-transform: uppercase; font-family: monospace;">
          <button class="p2p-btn-primary" id="p2pJoinBtn">Join</button>
        </div>
      </div>

      <!-- Create Room -->
      <div class="p2p-section">
        <h4>Or Start a New Room</h4>
        <div class="p2p-input-group">
          <button class="p2p-btn-secondary" id="p2pCreateBtn" style="flex:1">Start a Room</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Full-text Search Modal -->
  <div class="fulltext-overlay" id="fulltextOverlay">
    <div class="fulltext-panel" id="fulltextPanel">
      <div class="fulltext-header">
        <h3 id="fulltextTitle">Search Inside Book</h3>
        <button id="fulltextClose">âœ•</button>
      </div>
      <div class="fulltext-search-box">
        <input type="text" id="fulltextQuery" placeholder="Search text..." autofocus>
        <div class="fulltext-filters">
          <label title="Case sensitive search">
            <input type="checkbox" id="fulltextCaseSensitive">
            Aa
          </label>
          <label title="Whole words only">
            <input type="checkbox" id="fulltextWholeWords">
            W
          </label>
          <label title="Use regular expression">
            <input type="checkbox" id="fulltextRegex">
            .*
          </label>
        </div>
      </div>
      <div class="fulltext-status" id="fulltextStatus">Enter search text...</div>
      <div class="fulltext-results" id="fulltextResults"></div>
    </div>
  </div>

  <!-- Context View Modal -->
  <div class="context-overlay" id="contextOverlay">
    <div class="context-panel" id="contextPanel">
      <div class="context-header">
        <h3 id="contextTitle">Passage</h3>
        <div class="context-actions">
          <button id="contextExcerptBtn" class="context-excerpt-btn" title="Open in Excerpt View">âœ’ï¸</button>
          <button id="contextClose">âœ•</button>
        </div>
      </div>
      <div class="context-controls">
        <label>
          Context words:
          <input type="number" id="contextWordsInput" min="0" max="500" value="100" step="10">
        </label>
        <label>
          <input type="checkbox" id="contextExactMatch" checked>
          Show exact match
        </label>
      </div>
      <div class="context-content" id="contextContent"></div>
      <div class="context-footer">
        <span id="contextPosition"></span>
        <button id="contextReadHere" class="context-read-btn">Read from here</button>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <a href="https://github.com/petethomas/gutex" target="_blank" rel="noopener" title="View on GitHub"><svg height="16" width="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a>
  </footer>

  <script>
/* JS_PLACEHOLDER */
  </script>
</body>
</html>
